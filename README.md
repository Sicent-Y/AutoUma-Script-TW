# AutoUma_tw_Script
赛马娘凹种马根本不是人干的事，由于没有找到免费的、手机版、繁中服的自动化脚本，遂自己动手编写了一个超级简陋的。

# 功能
- 该脚本**单次运行**只能进行一次**单轮育成**。
- 进入育成后，脚本将自动读取训练、状态，自动选择训练、休息、外出或前往比赛，循环执行78个回合完成一轮育成
- 脚本使用**adb**进行操作，需要用电脑连接手机，控制手机自动游玩赛马娘游戏；adb连接的该设备**不应**被操作、打断(包括弹出通知、切换屏幕),**否则将会卡死** *详细内容见后*
- 代码识别范围狭窄，**不能够**自动选择剧本、培育马娘、种马与支援卡。请手动操作，将页面导航至**开始育成前的最后一步**再运行代码(也就是确认支援卡后，弹出的确认开始育成弹窗，确保体力足够进行一次育成；此时再运行代码，**否则将会卡死** *详细内容见后*)
- 代码运行将在育成完成获取技能的界面处**结束**，之后需要手动查收；代码执行完成后会自动让手机熄屏
- 具体使用方法，会在后面的使用方法里介绍

# 原理
- 通过adb连接手机，截取手机屏幕进行判断，随后模拟点击
- 通过`opencv`库的`matchtemplate`函数进行模板匹配，通过访问`source\data\`文件夹内存储的模板图像，匹配手机截屏，以此判断页面、训练信息、按钮位置等
  - 注意：模板匹配对分辨率敏感，该脚本在1080x2400分辨率下开发，请确保你的设备分辨率一致，否则将会卡死 *详细内容见后*
- 每一回合会根据获取的信息，按照一定的算法，计算各项操作的权重，最后选取权重最高者执行(休息、外出、保健室、五种训练、比赛)
  
# 配置环境
> 安装Python>=3.8
> 
> 安装Git
> 
> 闲置的、支持adb的Android手机
>
> Android端繁中服赛马娘
> 
> 正确的网络连接

### 安装脚本运行环境
#### 克隆GitHub仓库

在你的目录下打开cmd，输入如下内容克隆仓库
```
git clone https://github.com/Sicent-Y/AutoUma_tw_Script
```

运行完成后，会在你的目录下创建一个AutoUma_tw_Script文件夹

#### 创建python虚拟环境

进入AutoUma_tw_Script文件夹，在该目录下重新打开cmd；或者你也可以不关闭刚才打开的cmd窗口，输入`cd AutoUma_tw_Script`进入AutoUma_tw_Script目录

输入如下代码创建虚拟环境
```
python -m venv AutoUma
```

进入虚拟环境
```
.\AutoUma\Scripts\activate.bat
```

安装依赖
```
pip install -r requiremnets.txt
```

这可能需要一些时间，你可以使用国内镜像源，这样会快一些`pip install -r requiremnets.txt -i https://pypi.tuna.tsinghua.edu.cn/simple`

### 配置adb连接
该仓库自带有adb工具包，无需额外手动安装
#### 手机adb设置
打开开发者选项



